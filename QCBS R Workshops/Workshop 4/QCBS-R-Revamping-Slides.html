<!DOCTYPE html>
<html>
  <head>
    <title>Workshop 4: Linear models</title>
    <meta charset="utf-8">
    <meta name="author" content="Québec Centre for Biodiversity Science" />
    <link href="assets/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="assets/font-awesome-4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/academicons-1.8.1/css/academicons.min.css">
    <link rel="stylesheet" href="qcbsR.css" type="text/css" />
    <link rel="stylesheet" href="qcbsR-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Workshop 4: Linear models
## QCBS R Workshop Series
### Québec Centre for Biodiversity Science

---

&lt;!-- devtools::install_github('yihui/xaringan') --&gt;

## Workshop 4: Linear models

![:scale 40%](images/QCBS_logo_text.png)

Website: http://qcbs.ca/wiki/r/workshop4

---
## Learning objectives

.center[
![:scale 40%](images/schema_slide1.png)
]

---
## Review: Simple linear regression

Linear relationship between response (Y) and explanatory (X) variable

`\(Y_i = α + βX_i  + ε_i\)`
![:scale 40%](images/graphlm1.png)

###Assumptions
- Continuous explanatory variable
- Homogeneous and normally distributed error
- Independent residuals
- No outlier

---
## Review: Simple linear regression

- **Least squares**: most used method and corresponds to the default function in R

![:scale 40%](images/graphlm2.2.png)

### Assumptions

- `\(Y_i\)` : Observed value (measured) at `\(X_i\)`
- `\(\widehat{Y}_i\)` : Predicted value at `\(X_i\)`
- `\(\bar{Y}\)` : Mean value of all `\(Y_i\)`
- `\(V_E\)` : Residual variance (error)
- `\(V_R\)` : Variance explained by the regression
- `\(V_T\)` : Total variance
- `\(R^2 = \frac{V_R}{V_T}\)`
  

---
## Running a regression in R

###Step 1: Run your linear model

###Step 2: Verify assumptions

Assumptions are met

###Step 3: Estimate parameters (regression coefficients), test significance, plot your model

Assumptions are not met

Can you transform your variables (and does it make sense to do so)?

Yes: Go back to Step 1 with transformed variables
No: Try GLM that might better suit your data

---
## Running a regression in R

### **Step 1:** Run your linear model

In R, the function `lm()` is used to fit a linear model


```r
lm1 &lt;- lm(Y~X)
```

- `lm1` : New object containing the linear model we created
- `Y` : Response variable
- `X` : Explanatory variable

---
## Running a regression in R

Download the &lt;span style="color:blue"&gt; *birdsdiet* &lt;/span&gt; dataset:




```r
setwd()
bird &lt;- read.csv("birdsdiet.csv")
```

Visualize the data using the structure `str()` command: 


```r
str(bird)
```

```
'data.frame':	54 obs. of  7 variables:
 $ Family   : Factor w/ 53 levels "Anhingas"... 
 $ MaxAbund : num  2.99 37.8 241.4 4.4 4.53 ...
 $ AvgAbund : num  0.674 4.04 23.105 0.595 2.963 ...
 $ Mass     : num  716 5.3 35.8 119.4 315.5 ...
 $ Diet     : Factor w/ 5 levels "Insect","InsectVert"
 $ Passerine: int  0 1 1 0 0 0 0 0 0 0 ...
 $ Aquatic  : int  0 0 0 0 1 1 1 0 1 1 ...
```

---
## Running a regression in R
Response variable: ***Bird abundance***    num: continuous

Explanatory variable: ***Bird mass***      num: continuous

```
'data.frame':	54 obs. of  7 variables:
 $ Family   : Factor w/ 53 levels "Anhingas"... 
 $ MaxAbund : num  2.99 37.8 241.4 4.4 4.53 ...
 $ AvgAbund : num  0.674 4.04 23.105 0.595 2.963 ...
 $ Mass     : num  716 5.3 35.8 119.4 315.5 ...
 $ Diet     : Factor w/ 5 levels "Insect","InsectVert"
 $ Passerine: int  0 1 1 0 0 0 0 0 0 0 ...
 $ Aquatic  : int  0 0 0 0 1 1 1 0 1 1 ...
```

We first want to test if bird maximum abundance is a function of bird mass 

```lm1 &lt;- lm(bird$MaxAbund ~ bird$Mass)```


---
## Thank you for attending!

![:scale 40%](images/QCBS_logo_text.png)

We want your feed back!
https://docs.googlgithube.com/spreadsheets/d/1BUZ24UZEMvsF16gxWOm8yAvM_A9DdIeSaOk6b61bzxQ/edit#gid=0
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="qcbsR-macros.js"></script>
<script>var slideshow = remark.create();
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
